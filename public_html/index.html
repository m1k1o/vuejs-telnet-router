<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Cisco Router</title>

    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <link href="bootstrap.css" rel="stylesheet" type="text/css" />
    <style>
        html, body, #app, #app > .row {
            height: 100%;
        }
        body {
            background: #222;
            color: #CCC;
            font-family: "Consolas", monospace;
        }
        .terminal {
            max-height:100%;
            overflow-y: auto;
        }
        .terminal_pre {
            white-space: pre;
        }
        .input, .batch {
            background: rgba(255,255,255,0.1);
            border: none;
            color:white;
            line-height: 1;
        }

        .batch {
            width: 100%;
        }
    </style>
</head>
<body>
    <div id="app" class="container-fluid py-2">
        <div class="row">
            <div class="col-6">
                <!--<button @click="socket.emit('restart_routers')" class="float-right">Restart all</button>-->
                <h1>Routers</h1>
                <ul v-for="(router, name) in routers">
                    <li>
                        <button @click="socket.emit('remove_router', name)">X</button>
                        {{ name }} @ {{ router.host }}:{{ router.port }} ({{ router.status }})
                        <button v-if="room == name" @click="Room(null)">Unselect</button>
                        <span v-if="room == name">selected... </span>
                        <button v-else @click="Room(name)">Select</button>
                    </li>
                </ul>

                <div class="mb-2">
                    <button @click="NewRouter()">+ Add Router</button>
                    <button @click="AutoAdd()">+ Auto Add</button>
                </div>

                <h1>Batch</h1>
                <textarea class="batch" v-model="batch" rows="5"></textarea>
                <div class="mb-2">
                    <button @click="Send(batch)">Send to All</button>
                    <button @click="Send(batch, [room]) ">Send to Selected</button>
                </div>
                
                <button @click="interfaces_modal = true">Interfaces</button>
            </div>
            <div class="col-6 terminal" ref="terminal">
                <h1>{{ room || '--inactive--' }} terminal</h1>
                <div class="terminal_pre" v-if="room">{{ terminal }}<input class="input" type="test" v-model="input" v-on:keyup.enter="Send(input, [room]);input='';" placeholder="Enter command here"><button @click="Send('\x03', [room]) ">CTRL+C</button></div>
            </div>
        </div>
                
        <modal v-if="new_router"  @close="new_router = false" style="color:black;">
            <div slot="header">
                <h1 class="mb-0"> + Add Router </h1>
            </div>
            <div slot="body" class="form-horizontal">

                <div class="form-group row">
                    <label class="col-sm-4 col-form-label">Name</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" v-model="new_router.name">
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label">Host</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" v-model="new_router.host">
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label">Port</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" v-model="new_router.port">
                    </div>
                </div>
            </div>
            <div slot="footer">
                <button v-on:click="socket.emit('add_router', new_router);new_router = false;" class="btn btn-success">+ Add Router</button>
                <button v-on:click="new_router = false" class="btn btn-secondary">Cancel</button>
            </div>
        </modal>

        <interfaces_modal
            :routers="routers"

            :opened="interfaces_modal"
            @closed="interfaces_modal = false"
            @execute="Execute($event)"
        ></interfaces_modal>
    </div>
        
    <script type="text/javascript" src="libs/socket.io.js"></script>
    <script type="text/javascript" src="libs/vue.js"></script>
    <script type="text/javascript" src="modal.js"></script>
    <script>

        var app = new Vue({
            el: '#app',
        })
    </script>
</body>
</html>
